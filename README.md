## 1 пункт:
* фул пандас, excel. Для пояснений по коду см. комментарии
* в директории data лежат исходные файлы от балыкиной !!(файлы не менять, результаты вычилений туда не сохранять)!!
* в директории results лежат результаты вычислений.
* results/full_BD_isAlive.xlsx - файл с результатом первого пункта ( dataframe только с данными пациентов, у которых известен исход (жив/ мертв) ). В файле слиты данные из бд_моно и бд_бе_моно. Порядок и названия столбцов как в бд_без_моно.

## 2 пункт:
* results/<название вакцины на русском>.xlsx - файл по каждой вакцине (в том числе "Нет" - отсутствие вакцинации). Использовать в 3 пункте.
  
## 3 пункт:
* Формирование пар пациентов <br/>
    Для каждой группы и каждого пола (м и ж):<br/>
    1)Фильтруем по полу.<br/>
    2)Объединяем с F_data и D_data по CaseID.<br/>
    
* Создаём попарные сочетания пациентов с учётом:<br/>
  разницы возраста ≤ 3 лет,<br/>
  расхождения уровней F и D ≤ 10%,<br/>
  одинаковой степени тяжести и<br/>
  либо оба не вакцинированы, либо обеим введена одна и та же вакцина.<br/>

| Файл | Описание |
| --- | --- |
| results/pairs_SputnikV_м.csv | Пары мужчин, вакцина **SputnikV** |
| results/pairs_SputnikV_ж.csv | Пары женщин, вакцина **SputnikV** |
| results/pairs_SputnikLight_м.csv | Пары мужчин, вакцина **SputnikLight** |
| results/pairs_SputnikLight_ж.csv | Пары женщин, вакцина **SputnikLight** |
| results/pairs_EpiVacCorona_м.csv | Пары мужчин, вакцина **EpiVacCorona** |
| results/pairs_EpiVacCorona_ж.csv | Пары женщин, вакцина **EpiVacCorona** |
| results/pairs_KoviVac_м.csv | Пары мужчин, вакцина **KoviVac** |
| results/pairs_KoviVac_ж.csv | Пары женщин, вакцина **KoviVac** |
| results/pairs_Unvaccinated_м.csv | Пары мужчин **без вакцинации** |
| results/pairs_Unvaccinated_ж.csv | Пары женщин **без вакцинации** |

## 4 пункт:

| Вакцина | Пол | Всего пар (исходно) | Отобрано пар | p (возраст) | Нз (возраст) | p (ферритин) | Нз (ферритин) | p (D-димер) | Нз (D-димер) |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| KoviVac | м | 406 | 14 | 0.0355 | ❌ | 0.9515 | ✅ | 0.9032 | ✅ |
| SputnikLight | ж | 1378 | 26 | 0.0014 | ❌ | 0.0559 | ✅ | 0.0247 | ❌ |
| EpiVacCorona | м | 171 | 9 | 0.0872 | ✅ | 0.1289 | ✅ | 0.1641 | ✅ |
| SputnikV | ж | 70876 | 188 | 0.0 | ❌ | 0.0 | ❌ | 0.0 | ❌ |
| Unvaccinated | м | 2043231 | 1011 | 0.0 | ❌ | 0.0 | ❌ | 0.0 | ❌ |
| SputnikV | м | 44253 | 149 | 0.0 | ❌ | 0.0 | ❌ | 0.0 | ❌ |
| Unvaccinated | ж | 3576320 | 713 | 0.0 | ❌ | 0.0 | ❌ | 0.0 | ❌ |
| KoviVac | ж | 703 | 19 | 0.0016 | ❌ | 0.3525 | ✅ | 0.001 | ❌ |
| EpiVacCorona | ж | 741 | 19 | 0.0003 | ❌ | 0.0546 | ✅ | 0.0361 | ❌ |
| SputnikLight | м | 1035 | 23 | 0.0018 | ❌ | 0.56 | ✅ | 0.0067 | ❌ |

#### Легенда таблицы:

| Столбец                 | Описание                                                                               |
| ----------------------- | -------------------------------------------------------------------------------------- |
| **Вакцина**             | Название вакцины или "Unvaccinated" — контрольная группа без вакцинации                |
| **Пол**                 | м = мужской, ж = женский                                                               |
| **Всего пар (исходно)** | Общее количество пар "вакцинированный–невакцинированный" после фильтрации, до отбора   |
| **Отобрано пар**        | Количество пар, реально включённых в анализ после matching по основным параметрам      |
| **p (возраст)**         | p-значение критерия (обычно Mann–Whitney или t-test) для сравнения возраста в группах  |
| **Нз (возраст)**        | Нулевая значимость: **False** = статистически значимо (p < 0.05), **True** = незначимо |
| **p (ферритин)**        | То же самое — сравнение уровня ферритина                                               |
| **Нз (ферритин)**       | Флаг значимости по ферритину                                                           |
| **p (D-димер)**         | То же — сравнение уровня D-димера                                                      |
| **Нз (D-димер)**        | Флаг значимости по D-димеру                                                            |


#### Объяснение столбцов:
* Всего пар (исходно) – общее число уникальных непересекающихся пар после удаления самопар и дубликатов.
* Отобрано пар – число пар, оставшихся после one-to-one matching (каждый пациент участвует только в одной паре).
* p (возраст) – [p-value](https://en.wikipedia.org/wiki/P-value) парного [t-теста](https://en.wikipedia.org/wiki/Student%27s_t-test) для сравнения возрастов участников пары.
* Нз (возраст) – ✅ если возрастные различия не значимы, ❌ если значимы.
* Нз (ферритин) – ✅ если различия по ферритину не значимы, ❌ если значимы.
* p (D-димер) – p-value [Wilcoxon-теста](https://en.wikipedia.org/wiki/Wilcoxon_signed-rank_test) для D-димера.
* Нз (D-димер) – ✅ если различия по D-димеру не значимы, ❌ если значимы.
  ###### p = 0.0 означает, что p-value чрезвычайно мало (например, < 2.2e-16) и округлено до нуля. Это говорит о высокой статистической значимости различий между группами.

### Выводы и интерпретация:

##### Контрольные группы (Unvaccinated):
  * У обоих полов все различия статистически значимы (p = 0.0). (т.к. cамая большая группа)
    
##### KoviVac:
  * Мужчины: Значимые различия по возрасту, ферритин и D-димер — выровнены (не различаются);

  * Женщины: Значимые различия по возрасту и D-димеру, ферритин — выровнен.

##### SputnikLight:
  * Женщины: Все параметры различаются статистически значимо (наименее выражено по D-димеру: p = 0.0247);
  * Мужчины: Отличия по возрасту и D-димеру; ферритин — незначим.

##### EpiVacCorona:
  * Мужчины: Все три переменные сбалансированы (p > 0.05);
  * Женщины: Значимые различия по возрасту и D-димеру; ферритин на границе значимости.
    
##### SputnikV:
  * И мужчины, и женщины: Все сравнения показывают значимые различия (p = 0.0). Это говорит о сильной несбалансированности групп даже после matching, в отличие от других вакцин.


## 5 пункт:

## 6 пункт:

